<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <title>HHOMEPAGE</title>
    <style>
        .card-body {
            display: grid;
            grid-template-rows: repeat(4, 1fr); /* Creates four equal-height rows */
            gap: 10px; /* Sets consistent spacing between rows */
            padding: 10px;
        }
        .booking-btn {
            height: 40px; /* Fixed height for all buttons */
            width: 90%; /* Consistent width relative to the card size */
            margin: auto; /* Centers button in the grid row */
            padding: 5px 10px; /* Padding inside the button */
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            border: none; /* Removes default button border */
            color: white; /* Text color */
            font-size: 16px; /* Text size */
        }
        .card {
            width: 100%;
            max-width: 300px; /* Max width of the card */
            margin: 10px auto; /* Centering the card with automatic margins */
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Subtle shadow for depth */
        }
    </style>
    
    
    
</head>


<body class="">
    <div class="ps-2 navbar bg-success " style="background-image: url('/public/img/homepage3.jpg');">
        <div>
            <a href="#" class="text-white navbar ps-5 fw-bold">HOMEPAGE</a>
        </div>
        <div class="">
            <a href="#" class="text-white px-4" style="text-decoration: none">History</a>
            <a href="#" class="text-white px-4" style="text-decoration: none" onclick="openRequestStatus()">Request</a>
            <img src="/public/img/login.jpg" alt="Logo" width="60px" height="60px" class="rounded-circle shadow ">
            <button class="btn shadow form text-white"><i class="fas fa-sign-out-alt"></i></button>

        </div>
    </div>
    <div class="border-bottom"></div>

    <div class="bg-dark rounded-5 shadow  mx-5 " style="background-image: url('/public/img/backgrond2.jpg');">
        <h4 class="p-4 mt-3 text-white  text-center mb-5  fw-bold" id="day">
            </h5>
    </div>
    </div>
    <div id="Roomslot" class="d-flex flex-wrap container  justify-content-center  fw-bold"></div>

    <footer class="bg-dark mt-3 pt-5 pb-3" style="background-image: url('/public/img/homepage3.jpg');"></footer>
    <script>
        let Roomslot = [
            { "title": "Multimedia-001", "Status8_10": "FREE", "Status10_12": "RESERVED", "Status13_15": "DISABLED", "Status15_17": "PENDING", "image": "Multimedia.jpg" },
            { "title": "Multimedia-002", "Status8_10": "FREE", "Status10_12": "FREE", "Status13_15": "RESERVED", "Status15_17": "FREE", "image": "Multimedia.jpg" },
            { "title": "Multimedia-003", "Status8_10": "RESERVED", "Status10_12": "PENDING", "Status13_15": "FREE", "Status15_17": "DISABLED", "image": "Multimedia.jpg" },
            { "title": "Multimedia-004", "Status8_10": "FREE", "Status10_12": "FREE", "Status13_15": "RESERVED", "Status15_17": "PENDING", "image": "Multimedia.jpg" },
            { "title": "Reading room-001", "Status8_10": "FREE", "Status10_12": "PENDING", "Status13_15": "RESERVED", "Status15_17": "DISABLED", "image": "reading.jpeg" },
            { "title": "Reading room-002", "Status8_10": "PENDING", "Status10_12": "DISABLED", "Status13_15": "RESERVED", "Status15_17": "FREE", "image": "reading.jpeg" },
            { "title": "Reading room-003", "Status8_10": "RESERVED", "Status10_12": "PENDING", "Status13_15": "FREE", "Status15_17": "FREE", "image": "reading.jpeg" },
            { "title": "Reading room-004", "Status8_10": "PENDING", "Status10_12": "DISABLED", "Status13_15": "RESERVED", "Status15_17": "FREE", "image": "reading.jpeg" },
            { "title": "Study room-001", "Status8_10": "FREE", "Status10_12": "PENDING", "Status13_15": "FREE", "Status15_17": "FREE", "image": "studyroom.jpg" },
            { "title": "Study room-002", "Status8_10": "PENDING", "Status10_12": "RESERVED", "Status13_15": "FREE", "Status15_17": "FREE", "image": "studyroom.jpg" },
            { "title": "Study room-003", "Status8_10": "FREE", "Status10_12": "FREE", "Status13_15": "FREE", "Status15_17": "FREE", "image": "studyroom.jpg" },
            { "title": "Study room-004", "Status8_10": "DISABLED", "Status10_12": "PENDING", "Status13_15": "FREE", "Status15_17": "FREE", "image": "studyroom.jpg" },
        ];
        let container = document.querySelector('#Roomslot');
Roomslot.forEach(room => {
    let card = document.createElement('div');
    card.className = 'card shadow mx-3 mb-5 p-3 text-center border-dark border-2';
    card.style.width = '290px';

    let card_body = document.createElement('div');
    card_body.className = 'card-body row';
    card.appendChild(card_body);

    let card_title = document.createElement('h4');
    card_title.className = 'card-title';
    card_title.textContent = room.title;
    card_body.appendChild(card_title);

    // Create and append buttons only for 'FREE' status
    createStatusButton(card_body, room, room.Status8_10, "8:00-10:00 AM");
    createStatusButton(card_body, room, room.Status10_12, "10:00-12:00 AM");
    createStatusButton(card_body, room, room.Status13_15, "13:00-15:00 PM");
    createStatusButton(card_body, room, room.Status15_17, "15:00-17:00 PM");

    container.appendChild(card); // Ensure card is appended to container
});


function createStatusButton(card_body, room, status, label) {
    if (status === 'FREE') {
        let button = document.createElement('button');
        button.className = `booking-btn ${getClassByStatus(status)}`;
        button.textContent = label;
        button.setAttribute('onclick', `openBookingPopup(${JSON.stringify(room)}, '${label}')`);
        card_body.appendChild(button);
    }
}





function openBookingPopup(room, timeSlotLabel) {
    const bookingFormHtml = `
        <div style="position: relative; display: flex; justify-content: center; align-items: center; background-color: #f0f0f0; padding: 20px;">
            <div style="display: flex; flex-direction: row; align-items: stretch; max-height: 80vh; overflow: hidden; margin: 10px;">
                <div class="image-container" style="flex: 1; overflow: hidden; margin-right: 10px; border-radius: 5%;">
                    <img src="../Public/img/request.jpeg" alt="Request Image" style="width: 100%; height: auto; object-fit: cover;">
                </div>
                <div class="form-container" style="flex: 1; background-color: #fff; padding: 20px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); overflow: auto; border-radius: 5%;">
                    <div style="margin-bottom: 20px;">
                        <h5>| ${room.title} |  | Time: ${timeSlotLabel} |</h5>
                    </div>
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label for="details-${room.title}" style="font-weight: bold;">Details</label>
                        <textarea id="details-${room.title}" name="details" style="width: 100%; height: 100px; resize: none; background-color: #f0f0f0; cursor: default; border: 1px solid #ccc; font-weight: normal; outline: none;" placeholder="Capacity: 3-5 Seats\nMonitor\nWhite Board" readonly onfocus="this.blur();"></textarea>
                    </div>
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label for="reason-${room.title}" style="font-weight: bold;">Reason</label>
                        <textarea id="reason-${room.title}" name="reason" style="width: 100%; height: 100px; resize: none; border: 1px solid #ccc;" placeholder="Enter your reason for booking"></textarea>
                    </div>
                    <div class="button-container" style="text-align: center;">
                        <button class="btn-booking" style="background-color: #000; color: #fff; padding: 10px 20px; border-radius: 5px; font-weight: bold;">Book Now</button>
                    </div>
                </div>
            </div>
            <i class="fas fa-times close" style="position: absolute; top: 0; right: 0; cursor: pointer; font-size: 2rem; color: black;" onclick="Swal.close();"></i>
        </div>
    `;

    Swal.fire({
        html: bookingFormHtml,
        showCloseButton: false,
        customClass: {
            popup: 'swal-wide',
            container: 'swal-container'
        },
        width: '80%',
        showConfirmButton: false,
        backdrop: true,
        allowOutsideClick: false,
        didOpen: () => {
            Swal.getPopup().querySelector('.btn-booking').addEventListener('click', () => {
                Swal.fire('Booking Confirmed', 'Your booking has been successfully made.', 'success');
            });
        }
    });
}

function openRequestStatus() {
    const requestStatusHtml = `
    <div style="position: relative; display: flex; justify-content: center; align-items: center; background-color: #f0f0f0; padding: 20px;">
        <div style="display: flex; flex-direction: row; align-items: stretch; max-height: 80vh; overflow: hidden; margin: 10px;">
            <div class="image-container" style="flex: 1; overflow: hidden; margin-right: 10px; border-radius: 5%;">
                <img src="../Public/img/request.jpeg" alt="Request Image" style="width: 100%; height: auto; object-fit: cover;">
            </div>
            <div class="form-container" style="flex: 1; background-color: #fff; padding: 20px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); overflow: auto; border-radius: 5%;">
                <div style="margin-bottom: 20px;">
                    <h5 style="margin: 0;">Room: 001 | Time: 8:00 - 10:00</h5>
                </div>
                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="font-weight: bold;">Details</label>
                    <textarea style="width: 100%; height: 100px; resize: none; background-color: #f0f0f0; cursor: default; border: 1px solid #ccc; font-weight: normal; outline: none;" placeholder="Capacity: 3-5 Seats\nMonitor\nWhite Board" readonly onfocus="this.blur();"></textarea>
                </div>
                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="font-weight: bold;">Reason</label>
                    <textarea style="width: 100%; height: 100px; resize: none; border: 1px solid #ccc;" placeholder="Enter your reason for booking" readonly></textarea>
                </div>
                <div class="button-container" style="text-align: center;">
                    <div class="status status-pending" style="font-size: 18px; margin-bottom: 10px; color: #c1522d; font-weight: bold;"><span>Booking Status: Pending Approval</span></div>
                </div>
            </div>
        </div>
        <i class="fas fa-times close" style="position: absolute; top: 0; right: 0; cursor: pointer; font-size: 2rem; color: black;" onclick="Swal.close();"></i>
    </div>
    `;

    Swal.fire({
        html: requestStatusHtml,
        showCloseButton: false,
        customClass: {
            popup: 'swal-wide',
            container: 'swal-container'
        },
        width: '80%',
        showConfirmButton: false,
        backdrop: true,
        allowOutsideClick: false
    });
}


function getClassByStatus(status) {
    switch (status) {
        case 'FREE': return 'btn card-text text-white shadow mt-2 bg-dark px-5';
        case 'PENDING': return 'btn card-text text-white shadow mt-2 bg-warning px-5';
        case 'RESERVED': return 'btn card-text text-white shadow mt-2 bg-primary px-5';
        case 'DISABLED': return 'btn card-text text-white shadow mt-2 bg-danger px-5';
        default: return 'btn card-text text-white shadow mt-2 bg-secondary px-5';
    }
}

var dayElement = document.getElementById('day');
var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth() + 1;
var year = currentDate.getFullYear();
dayElement.textContent = day + ' / ' + month + ' / ' + year;

    </script>
</body>

</html>